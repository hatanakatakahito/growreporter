# GrowReporter v1.1.0 å®Ÿè£…è¨ˆç”»

## ğŸ“‹ ç¾åœ¨ã®çŠ¶æ…‹ï¼ˆv1.0.0ï¼‰

### âœ… å®Œæˆæ¸ˆã¿æ©Ÿèƒ½
- Firebase Authenticationï¼ˆGoogle SSOã€Email/Passwordï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ãƒ»ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢
- ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±è£œå®Œç”»é¢
- ã‚µã‚¤ãƒˆç™»éŒ²ï¼ˆ5ã‚¹ãƒ†ãƒƒãƒ—ï¼‰
  - STEP 1: åŸºæœ¬æƒ…å ±å…¥åŠ›
  - STEP 2: GA4é€£æºï¼ˆãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³å¯¾å¿œï¼‰
  - STEP 3: Search Consoleé€£æºï¼ˆãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³å¯¾å¿œï¼‰
  - STEP 4: ã‚³ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¨­å®š
  - STEP 5: KPIè¨­å®š
- ã‚µã‚¤ãƒˆä¸€è¦§ãƒ»ç·¨é›†ãƒ»å‰Šé™¤
- ã‚µã‚¤ãƒˆåˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
- åŸºæœ¬çš„ãªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆHeaderã€Sidebarã€MainLayoutï¼‰
- TailGrids React Pro UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆçµ±åˆ
- react-select ã«ã‚ˆã‚‹æ¤œç´¢å¯èƒ½ãªã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹

### ğŸ”§ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- React 19.0.0
- Vite 6.2.0
- Tailwind CSS 3.4.18
- Firebase (Authentication, Firestore)
- React Router DOM 7.2.0
- react-select

---

## ğŸ¯ v1.1.0 å®Ÿè£…è¨ˆç”»

### ç›®æ¨™
**APIéƒ½åº¦å‘¼ã³å‡ºã— + è³¢ã„ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ã«ã‚ˆã‚‹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ§‹ç¯‰**

v1.1.0ã§ã¯ã€ç”»é¢è¡¨ç¤ºæ™‚ã«GA4ã¨Search Console APIã‹ã‚‰ç›´æ¥ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€å¤šå±¤ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨ã‚³ã‚¹ãƒˆã‚’æœ€é©åŒ–ã—ã¾ã™ã€‚

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ç‰¹å¾´
- âœ… **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿**: å¸¸ã«æœ€æ–°ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤º
- âœ… **ã‚·ãƒ³ãƒ—ãƒ«**: å®šæœŸçš„ãªãƒ‡ãƒ¼ã‚¿åé›†ãŒä¸è¦
- âœ… **ä½ã‚³ã‚¹ãƒˆ**: å¤šå±¤ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã§APIå‘¼ã³å‡ºã—ã‚’æœ€å°åŒ–ï¼ˆæœˆé¡ $0.07ï¼‰
- âœ… **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«**: 1,000ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ Ã— 3ã‚µã‚¤ãƒˆã¾ã§å¯¾å¿œ

### å¤šå±¤ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥
```
ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
    â†“
[Layer 1] TanStack Queryï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰
    â†“ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒŸã‚¹
[Layer 2] Firestoreè»½é‡ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆ1æ™‚é–“æœ‰åŠ¹ï¼‰
    â†“ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒŸã‚¹
[Layer 3] GA4/GSC APIå‘¼ã³å‡ºã—
```

**ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡: 80%ä»¥ä¸Šã‚’ç›®æ¨™**

---

## ğŸ“¦ Phase 1: Firebase Functions å®Ÿè£…ï¼ˆå„ªå…ˆåº¦: æœ€é«˜ï¼‰

### 1.1 Firebase Functions ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
**ç›®çš„**: Callable Functionsã®åŸºç›¤æ§‹ç¯‰

#### ã‚¿ã‚¹ã‚¯
- [ ] Firebase Functions ã®åˆæœŸåŒ–
  ```bash
  cd functions
  npm install firebase-functions firebase-admin googleapis
  ```

- [ ] ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
  ```bash
  # functions/.env
  GOOGLE_CLIENT_ID=your_client_id
  GOOGLE_CLIENT_SECRET=your_client_secret
  ```

- [ ] `functions/package.json` ã®ä¾å­˜é–¢ä¿‚
  ```json
  {
    "dependencies": {
      "firebase-functions": "^5.0.0",
      "firebase-admin": "^12.0.0",
      "googleapis": "^134.0.0"
    }
  }
  ```

- [ ] ãƒ­ãƒ¼ã‚«ãƒ«ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã®è¨­å®š
  ```bash
  firebase emulators:start --only functions,firestore
  ```

#### æˆæœç‰©
- `functions/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å®Œå…¨ãªã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- ãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½ãªçŠ¶æ…‹

---

### 1.2 GA4ãƒ‡ãƒ¼ã‚¿å–å¾— Callable Function
**ç›®çš„**: GA4 APIã‹ã‚‰ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

#### ã‚¿ã‚¹ã‚¯
- [ ] **åŸºæœ¬æ§‹é€ ã®å®Ÿè£…**
  ```javascript
  // functions/src/ga4/fetchGA4Data.js
  const functions = require('firebase-functions');
  const { google } = require('googleapis');
  const admin = require('firebase-admin');
  
  exports.fetchGA4Data = functions.https.onCall(async (data, context) => {
    // 1. èªè¨¼ãƒã‚§ãƒƒã‚¯
    // 2. ã‚µã‚¤ãƒˆæ‰€æœ‰æ¨©ç¢ºèª
    // 3. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚§ãƒƒã‚¯
    // 4. ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—ãƒ»æ›´æ–°
    // 5. GA4 APIå‘¼ã³å‡ºã—
    // 6. ãƒ‡ãƒ¼ã‚¿æ•´å½¢
    // 7. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¿å­˜
    // 8. çµæœè¿”å´
  });
  ```

- [ ] **èªè¨¼ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**
  ```javascript
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ãƒã‚§ãƒƒã‚¯
  if (!context.auth) {
    throw new functions.https.HttpsError(
      'unauthenticated',
      'ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ãŒå¿…è¦ã§ã™'
    );
  }
  
  // ã‚µã‚¤ãƒˆæ‰€æœ‰æ¨©ç¢ºèª
  const siteDoc = await db.collection('sites').doc(siteId).get();
  if (!siteDoc.exists || siteDoc.data().userId !== context.auth.uid) {
    throw new functions.https.HttpsError(
      'permission-denied',
      'ã“ã®ã‚µã‚¤ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“'
    );
  }
  ```

- [ ] **è»½é‡ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å®Ÿè£…**
  ```javascript
  // Firestoreã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚§ãƒƒã‚¯ï¼ˆ1æ™‚é–“æœ‰åŠ¹ï¼‰
  const cacheKey = `${siteId}_${startDate}_${endDate}`;
  const cacheDoc = await db.collection('api_cache').doc(cacheKey).get();
  
  if (cacheDoc.exists) {
    const cache = cacheDoc.data();
    const cacheAge = Date.now() - cache.timestamp.toMillis();
    
    if (cacheAge < 60 * 60 * 1000) { // 1æ™‚é–“
      console.log('Cache hit:', cacheKey);
      return cache.data;
    }
  }
  ```

- [ ] **OAuthãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†**
  ```javascript
  // ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—
  const tokenDoc = await db
    .collection('oauth_tokens')
    .doc(siteData.ga4OauthTokenId)
    .get();
  
  const tokenData = tokenDoc.data();
  const oauth2Client = new google.auth.OAuth2(
    process.env.GOOGLE_CLIENT_ID,
    process.env.GOOGLE_CLIENT_SECRET
  );
  
  oauth2Client.setCredentials({
    access_token: tokenData.access_token,
    refresh_token: tokenData.refresh_token,
  });
  
  // ãƒˆãƒ¼ã‚¯ãƒ³æœŸé™åˆ‡ã‚Œãªã‚‰è‡ªå‹•æ›´æ–°
  const expiresAt = tokenData.expires_at.toDate();
  if (expiresAt <= new Date()) {
    const { credentials } = await oauth2Client.refreshAccessToken();
    
    await db.collection('oauth_tokens').doc(siteData.ga4OauthTokenId).update({
      access_token: credentials.access_token,
      expires_at: new Date(credentials.expiry_date),
      updated_at: admin.firestore.FieldValue.serverTimestamp(),
    });
    
    oauth2Client.setCredentials(credentials);
  }
  ```

- [ ] **GA4 Data API å‘¼ã³å‡ºã—**
  ```javascript
  const analyticsData = google.analyticsdata('v1beta');
  
  // åŸºæœ¬æŒ‡æ¨™ã®å–å¾—
  const response = await analyticsData.properties.runReport({
    auth: oauth2Client,
    property: `properties/${siteData.ga4PropertyId}`,
    requestBody: {
      dateRanges: [{ startDate, endDate }],
      metrics: [
        { name: 'sessions' },
        { name: 'totalUsers' },
        { name: 'screenPageViews' },
        { name: 'engagementRate' },
      ],
    },
  });
  
  // ã‚³ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã®å–å¾—
  const cvResponse = await analyticsData.properties.runReport({
    auth: oauth2Client,
    property: `properties/${siteData.ga4PropertyId}`,
    requestBody: {
      dateRanges: [{ startDate, endDate }],
      dimensions: [{ name: 'eventName' }],
      metrics: [{ name: 'eventCount' }],
      dimensionFilter: {
        filter: {
          fieldName: 'eventName',
          inListFilter: {
            values: siteData.conversionEvents.map(e => e.eventName),
          },
        },
      },
    },
  });
  ```

- [ ] **ãƒ‡ãƒ¼ã‚¿æ•´å½¢ã¨è¿”å´**
  ```javascript
  const metrics = {
    sessions: parseInt(response.data.rows?.[0]?.metricValues?.[0]?.value || 0),
    totalUsers: parseInt(response.data.rows?.[0]?.metricValues?.[1]?.value || 0),
    screenPageViews: parseInt(response.data.rows?.[0]?.metricValues?.[2]?.value || 0),
    engagementRate: parseFloat(response.data.rows?.[0]?.metricValues?.[3]?.value || 0),
  };
  
  // ã‚³ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³é›†è¨ˆ
  const conversions = {};
  cvResponse.data.rows?.forEach(row => {
    const eventName = row.dimensionValues[0].value;
    const count = parseInt(row.metricValues[0].value);
    conversions[eventName] = count;
  });
  
  const totalConversions = Object.values(conversions).reduce((sum, val) => sum + val, 0);
  const conversionRate = metrics.sessions > 0 ? totalConversions / metrics.sessions : 0;
  
  const result = {
    metrics: {
      ...metrics,
      conversions,
      totalConversions,
      conversionRate,
    },
    period: { startDate, endDate },
    fetchedAt: new Date().toISOString(),
  };
  
  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜
  await db.collection('api_cache').doc(cacheKey).set({
    data: result,
    timestamp: admin.firestore.FieldValue.serverTimestamp(),
    siteId,
    userId: context.auth.uid,
  });
  
  return result;
  ```

- [ ] **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**
  ```javascript
  try {
    // ... å‡¦ç† ...
  } catch (error) {
    console.error('Error fetching GA4 data:', error);
    
    // ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’Firestoreã«ä¿å­˜
    await db.collection('error_logs').add({
      type: 'ga4_fetch_error',
      siteId,
      userId: context.auth.uid,
      error: error.message,
      timestamp: admin.firestore.FieldValue.serverTimestamp(),
    });
    
    throw new functions.https.HttpsError(
      'internal',
      'GA4ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message
    );
  }
  ```

#### æˆæœç‰©
- `functions/src/ga4/fetchGA4Data.js`
- `functions/src/utils/tokenManager.js`ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ã®å…±é€šåŒ–ï¼‰
- `functions/src/utils/cacheManager.js`ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†ã®å…±é€šåŒ–ï¼‰

#### ãƒ‡ãƒ¼ã‚¿æ§‹é€ 
```typescript
// è¿”å´ãƒ‡ãƒ¼ã‚¿
{
  metrics: {
    sessions: number;
    totalUsers: number;
    screenPageViews: number;
    engagementRate: number;
    conversions: {
      [eventName: string]: number;
    };
    totalConversions: number;
    conversionRate: number;
  };
  period: {
    startDate: string; // "2025-01-01"
    endDate: string;   // "2025-01-31"
  };
  fetchedAt: string; // ISO 8601
}

// Firestoreã‚­ãƒ£ãƒƒã‚·ãƒ¥æ§‹é€ 
// api_cache/{cacheKey}
{
  data: object; // ä¸Šè¨˜ã®è¿”å´ãƒ‡ãƒ¼ã‚¿
  timestamp: Timestamp;
  siteId: string;
  userId: string;
}
```

---

### 1.3 Search Console ãƒ‡ãƒ¼ã‚¿å–å¾— Callable Function
**ç›®çš„**: GSC APIã‹ã‚‰SEOãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

#### ã‚¿ã‚¹ã‚¯
- [ ] **åŸºæœ¬æ§‹é€ ã®å®Ÿè£…**ï¼ˆGA4ã¨åŒæ§˜ã®æ§‹é€ ï¼‰
  ```javascript
  // functions/src/gsc/fetchGSCData.js
  exports.fetchGSCData = functions.https.onCall(async (data, context) => {
    // GA4ã¨åŒæ§˜ã®æµã‚Œ
  });
  ```

- [ ] **Search Console API å‘¼ã³å‡ºã—**
  ```javascript
  const searchConsole = google.searchconsole('v1');
  
  // åŸºæœ¬æŒ‡æ¨™ã®å–å¾—
  const response = await searchConsole.searchanalytics.query({
    auth: oauth2Client,
    siteUrl: siteData.gscSiteUrl,
    requestBody: {
      startDate,
      endDate,
      dimensions: [], // å…¨ä½“ã®é›†è¨ˆ
      rowLimit: 1,
    },
  });
  
  // ãƒˆãƒƒãƒ—ã‚¯ã‚¨ãƒªã®å–å¾—
  const topQueriesResponse = await searchConsole.searchanalytics.query({
    auth: oauth2Client,
    siteUrl: siteData.gscSiteUrl,
    requestBody: {
      startDate,
      endDate,
      dimensions: ['query'],
      rowLimit: 10,
    },
  });
  
  // ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã®å–å¾—
  const topPagesResponse = await searchConsole.searchanalytics.query({
    auth: oauth2Client,
    siteUrl: siteData.gscSiteUrl,
    requestBody: {
      startDate,
      endDate,
      dimensions: ['page'],
      rowLimit: 10,
    },
  });
  ```

- [ ] **ãƒ‡ãƒ¼ã‚¿æ•´å½¢**
  ```javascript
  const result = {
    metrics: {
      clicks: response.data.rows?.[0]?.clicks || 0,
      impressions: response.data.rows?.[0]?.impressions || 0,
      ctr: response.data.rows?.[0]?.ctr || 0,
      position: response.data.rows?.[0]?.position || 0,
    },
    topQueries: topQueriesResponse.data.rows?.map(row => ({
      query: row.keys[0],
      clicks: row.clicks,
      impressions: row.impressions,
      ctr: row.ctr,
      position: row.position,
    })) || [],
    topPages: topPagesResponse.data.rows?.map(row => ({
      page: row.keys[0],
      clicks: row.clicks,
      impressions: row.impressions,
      ctr: row.ctr,
      position: row.position,
    })) || [],
    period: { startDate, endDate },
    fetchedAt: new Date().toISOString(),
  };
  ```

#### æˆæœç‰©
- `functions/src/gsc/fetchGSCData.js`

---

### 1.4 ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— Function
**ç›®çš„**: å¤ã„ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’è‡ªå‹•å‰Šé™¤ã—ã¦ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚³ã‚¹ãƒˆã‚’æœ€å°åŒ–

#### ã‚¿ã‚¹ã‚¯
- [ ] **å®šæœŸå®Ÿè¡Œã®å®Ÿè£…**
  ```javascript
  // functions/src/scheduled/cleanupCache.js
  exports.cleanupCache = functions.pubsub
    .schedule('0 3 * * *') // æ¯æ—¥åˆå‰3æ™‚
    .timeZone('Asia/Tokyo')
    .onRun(async (context) => {
      const db = admin.firestore();
      const oneDayAgo = Date.now() - 24 * 60 * 60 * 1000;
      
      const snapshot = await db
        .collection('api_cache')
        .where('timestamp', '<', new Date(oneDayAgo))
        .get();
      
      if (snapshot.empty) {
        console.log('No old cache to delete');
        return null;
      }
      
      // ãƒãƒƒãƒå‰Šé™¤
      const batch = db.batch();
      snapshot.docs.forEach(doc => {
        batch.delete(doc.ref);
      });
      
      await batch.commit();
      console.log(`Deleted ${snapshot.size} old cache entries`);
      
      return null;
    });
  ```

#### æˆæœç‰©
- `functions/src/scheduled/cleanupCache.js`

---

### 1.5 Functions ã®ãƒ‡ãƒ—ãƒ­ã‚¤
**ç›®çš„**: æœ¬ç•ªç’°å¢ƒã¸ã®å±•é–‹

#### ã‚¿ã‚¹ã‚¯
- [ ] **ç’°å¢ƒå¤‰æ•°ã®è¨­å®š**
  ```bash
  firebase functions:config:set \
    google.client_id="YOUR_CLIENT_ID" \
    google.client_secret="YOUR_CLIENT_SECRET"
  ```

- [ ] **ãƒ‡ãƒ—ãƒ­ã‚¤**
  ```bash
  firebase deploy --only functions
  ```

- [ ] **å‹•ä½œç¢ºèª**
  - ãƒ­ãƒ¼ã‚«ãƒ«ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã§ãƒ†ã‚¹ãƒˆ
  - æœ¬ç•ªç’°å¢ƒã§ãƒ†ã‚¹ãƒˆ
  - ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®ç¢ºèª

#### æˆæœç‰©
- ãƒ‡ãƒ—ãƒ­ã‚¤æ¸ˆã¿ã®Functions
- å‹•ä½œç¢ºèªãƒ¬ãƒãƒ¼ãƒˆ

---

## ğŸ“Š Phase 2: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…ï¼ˆå„ªå…ˆåº¦: é«˜ï¼‰

### 2.1 TanStack Query ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
**ç›®çš„**: åŠ¹ç‡çš„ãªãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†

#### ã‚¿ã‚¹ã‚¯
- [ ] **ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**
  ```bash
  npm install @tanstack/react-query
  ```

- [ ] **QueryClient ã®è¨­å®š**
  ```javascript
  // src/config/queryClient.js
  import { QueryClient } from '@tanstack/react-query';
  
  export const queryClient = new QueryClient({
    defaultOptions: {
      queries: {
        staleTime: 60 * 60 * 1000, // 1æ™‚é–“ã¯å†å–å¾—ã—ãªã„
        cacheTime: 24 * 60 * 60 * 1000, // 24æ™‚é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä¿æŒ
        refetchOnWindowFocus: false, // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ™‚ã«å†å–å¾—ã—ãªã„
        refetchOnMount: false, // ãƒã‚¦ãƒ³ãƒˆæ™‚ã«å†å–å¾—ã—ãªã„
        retry: 2, // å¤±æ•—æ™‚ã«2å›ãƒªãƒˆãƒ©ã‚¤
      },
    },
  });
  ```

- [ ] **App.jsx ã¸ã®çµ±åˆ**
  ```javascript
  // src/App.jsx
  import { QueryClientProvider } from '@tanstack/react-query';
  import { ReactQueryDevtools } from '@tanstack/react-query-devtools';
  import { queryClient } from './config/queryClient';
  
  function App() {
    return (
      <QueryClientProvider client={queryClient}>
        <AuthProvider>
          <SiteProvider>
            <Router>
              {/* ... routes ... */}
            </Router>
          </SiteProvider>
        </AuthProvider>
        <ReactQueryDevtools initialIsOpen={false} />
      </QueryClientProvider>
    );
  }
  ```

#### æˆæœç‰©
- `src/config/queryClient.js`
- æ›´æ–°ã•ã‚ŒãŸ `src/App.jsx`

---

### 2.2 ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã®ä½œæˆ
**ç›®çš„**: ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ­ã‚¸ãƒƒã‚¯ã®å†åˆ©ç”¨

#### ã‚¿ã‚¹ã‚¯
- [ ] **useGA4Data ãƒ•ãƒƒã‚¯ã®å®Ÿè£…**
  ```javascript
  // src/hooks/useGA4Data.js
  import { useQuery } from '@tanstack/react-query';
  import { httpsCallable } from 'firebase/functions';
  import { functions } from '../config/firebase';
  
  export function useGA4Data(siteId, startDate, endDate, options = {}) {
    return useQuery({
      queryKey: ['ga4-data', siteId, startDate, endDate],
      queryFn: async () => {
        const fetchGA4 = httpsCallable(functions, 'fetchGA4Data');
        const result = await fetchGA4({ siteId, startDate, endDate });
        return result.data;
      },
      enabled: !!siteId && !!startDate && !!endDate,
      ...options,
    });
  }
  ```

- [ ] **useGSCData ãƒ•ãƒƒã‚¯ã®å®Ÿè£…**
  ```javascript
  // src/hooks/useGSCData.js
  import { useQuery } from '@tanstack/react-query';
  import { httpsCallable } from 'firebase/functions';
  import { functions } from '../config/firebase';
  
  export function useGSCData(siteId, startDate, endDate, options = {}) {
    return useQuery({
      queryKey: ['gsc-data', siteId, startDate, endDate],
      queryFn: async () => {
        const fetchGSC = httpsCallable(functions, 'fetchGSCData');
        const result = await fetchGSC({ siteId, startDate, endDate });
        return result.data;
      },
      enabled: !!siteId && !!startDate && !!endDate,
      ...options,
    });
  }
  ```

- [ ] **useSiteMetrics ãƒ•ãƒƒã‚¯ã®å®Ÿè£…**ï¼ˆGA4 + GSCçµ±åˆï¼‰
  ```javascript
  // src/hooks/useSiteMetrics.js
  import { useGA4Data } from './useGA4Data';
  import { useGSCData } from './useGSCData';
  
  export function useSiteMetrics(siteId, startDate, endDate) {
    const ga4Query = useGA4Data(siteId, startDate, endDate);
    const gscQuery = useGSCData(siteId, startDate, endDate);
    
    return {
      ga4: ga4Query.data,
      gsc: gscQuery.data,
      isLoading: ga4Query.isLoading || gscQuery.isLoading,
      isError: ga4Query.isError || gscQuery.isError,
      error: ga4Query.error || gscQuery.error,
      refetch: () => {
        ga4Query.refetch();
        gscQuery.refetch();
      },
    };
  }
  ```

#### æˆæœç‰©
- `src/hooks/useGA4Data.js`
- `src/hooks/useGSCData.js`
- `src/hooks/useSiteMetrics.js`

---

### 2.3 æœŸé–“é¸æŠã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
**ç›®çš„**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåˆ†ææœŸé–“ã‚’é¸æŠã§ãã‚‹UI

#### ã‚¿ã‚¹ã‚¯
- [ ] **PeriodSelector ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å®Ÿè£…**
  ```javascript
  // src/components/Dashboard/PeriodSelector.jsx
  import React, { useState } from 'react';
  
  const PRESETS = [
    { label: 'éå»7æ—¥é–“', days: 7 },
    { label: 'éå»30æ—¥é–“', days: 30 },
    { label: 'éå»90æ—¥é–“', days: 90 },
  ];
  
  export default function PeriodSelector({ onPeriodChange }) {
    const [selectedPreset, setSelectedPreset] = useState(30);
    const [customStart, setCustomStart] = useState('');
    const [customEnd, setCustomEnd] = useState('');
    const [isCustom, setIsCustom] = useState(false);
    
    const handlePresetClick = (days) => {
      setSelectedPreset(days);
      setIsCustom(false);
      
      const endDate = new Date();
      const startDate = new Date();
      startDate.setDate(startDate.getDate() - days);
      
      onPeriodChange({
        startDate: startDate.toISOString().split('T')[0],
        endDate: endDate.toISOString().split('T')[0],
      });
    };
    
    const handleCustomApply = () => {
      if (customStart && customEnd) {
        onPeriodChange({
          startDate: customStart,
          endDate: customEnd,
        });
      }
    };
    
    return (
      <div className="rounded-lg border border-stroke bg-white p-4 dark:border-dark-3 dark:bg-dark-2">
        <div className="mb-4 flex items-center gap-2">
          {PRESETS.map((preset) => (
            <button
              key={preset.days}
              onClick={() => handlePresetClick(preset.days)}
              className={`rounded-md px-4 py-2 text-sm font-medium transition ${
                !isCustom && selectedPreset === preset.days
                  ? 'bg-primary text-white'
                  : 'border border-stroke text-dark hover:bg-gray-2 dark:border-dark-3 dark:text-white dark:hover:bg-dark-3'
              }`}
            >
              {preset.label}
            </button>
          ))}
          <button
            onClick={() => setIsCustom(true)}
            className={`rounded-md px-4 py-2 text-sm font-medium transition ${
              isCustom
                ? 'bg-primary text-white'
                : 'border border-stroke text-dark hover:bg-gray-2 dark:border-dark-3 dark:text-white dark:hover:bg-dark-3'
            }`}
          >
            ã‚«ã‚¹ã‚¿ãƒ 
          </button>
        </div>
        
        {isCustom && (
          <div className="flex items-end gap-3">
            <div className="flex-1">
              <label className="mb-2 block text-sm font-medium text-dark dark:text-white">
                é–‹å§‹æ—¥
              </label>
              <input
                type="date"
                value={customStart}
                onChange={(e) => setCustomStart(e.target.value)}
                className="w-full rounded-md border border-stroke px-4 py-2 text-sm dark:border-dark-3 dark:bg-dark-2"
              />
            </div>
            <div className="flex-1">
              <label className="mb-2 block text-sm font-medium text-dark dark:text-white">
                çµ‚äº†æ—¥
              </label>
              <input
                type="date"
                value={customEnd}
                onChange={(e) => setCustomEnd(e.target.value)}
                className="w-full rounded-md border border-stroke px-4 py-2 text-sm dark:border-dark-3 dark:bg-dark-2"
              />
            </div>
            <button
              onClick={handleCustomApply}
              disabled={!customStart || !customEnd}
              className="rounded-md bg-primary px-6 py-2 text-sm font-medium text-white transition hover:bg-opacity-90 disabled:cursor-not-allowed disabled:opacity-50"
            >
              é©ç”¨
            </button>
          </div>
        )}
      </div>
    );
  }
  ```

#### æˆæœç‰©
- `src/components/Dashboard/PeriodSelector.jsx`

---

### 2.4 ä¸»è¦æŒ‡æ¨™ã‚«ãƒ¼ãƒ‰ã®å®Ÿè£…
**ç›®çš„**: 6ã¤ã®ä¸»è¦æŒ‡æ¨™ã‚’è¦–è¦šçš„ã«è¡¨ç¤º

#### ã‚¿ã‚¹ã‚¯
- [ ] **MetricCard ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å®Ÿè£…**
  ```javascript
  // src/components/Dashboard/MetricCard.jsx
  import React from 'react';
  
  export default function MetricCard({ title, value, change, icon, isLoading }) {
    if (isLoading) {
      return (
        <div className="rounded-lg border border-stroke bg-white p-6 shadow-sm dark:border-dark-3 dark:bg-dark-2">
          <div className="animate-pulse">
            <div className="mb-2 h-4 w-24 rounded bg-gray-200 dark:bg-dark-3"></div>
            <div className="mb-2 h-8 w-32 rounded bg-gray-200 dark:bg-dark-3"></div>
            <div className="h-4 w-16 rounded bg-gray-200 dark:bg-dark-3"></div>
          </div>
        </div>
      );
    }
    
    const isPositive = change >= 0;
    
    return (
      <div className="rounded-lg border border-stroke bg-white p-6 shadow-sm dark:border-dark-3 dark:bg-dark-2">
        <div className="flex items-center justify-between">
          <div>
            <p className="text-sm font-medium text-body-color">{title}</p>
            <h3 className="mt-2 text-3xl font-bold text-dark dark:text-white">
              {value.toLocaleString()}
            </h3>
            {change !== undefined && (
              <div className="mt-2 flex items-center gap-1">
                <span
                  className={`text-sm font-medium ${
                    isPositive ? 'text-green-600' : 'text-red-600'
                  }`}
                >
                  {isPositive ? 'â†‘' : 'â†“'} {Math.abs(change).toFixed(1)}%
                </span>
                <span className="text-xs text-body-color">å‰æœŸé–“æ¯”</span>
              </div>
            )}
          </div>
          {icon && (
            <div className="flex h-14 w-14 items-center justify-center rounded-full bg-primary/10">
              {icon}
            </div>
          )}
        </div>
      </div>
    );
  }
  ```

- [ ] **MetricCards ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å®Ÿè£…**
  ```javascript
  // src/components/Dashboard/MetricCards.jsx
  import React from 'react';
  import MetricCard from './MetricCard';
  
  export default function MetricCards({ ga4Data, isLoading }) {
    const metrics = [
      {
        title: 'ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°',
        value: ga4Data?.metrics?.sessions || 0,
        change: 5.2, // TODO: å‰æœŸé–“æ¯”ã®è¨ˆç®—
        icon: (
          <svg className="h-7 w-7 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
          </svg>
        ),
      },
      {
        title: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°',
        value: ga4Data?.metrics?.totalUsers || 0,
        change: 3.8,
        icon: (
          <svg className="h-7 w-7 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
          </svg>
        ),
      },
      {
        title: 'ãƒšãƒ¼ã‚¸ãƒ“ãƒ¥ãƒ¼æ•°',
        value: ga4Data?.metrics?.screenPageViews || 0,
        change: 7.1,
        icon: (
          <svg className="h-7 w-7 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
          </svg>
        ),
      },
      {
        title: 'ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡',
        value: ((ga4Data?.metrics?.engagementRate || 0) * 100).toFixed(1) + '%',
        change: 2.3,
        icon: (
          <svg className="h-7 w-7 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
          </svg>
        ),
      },
      {
        title: 'ã‚³ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ•°',
        value: ga4Data?.metrics?.totalConversions || 0,
        change: 12.5,
        icon: (
          <svg className="h-7 w-7 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
          </svg>
        ),
      },
      {
        title: 'ã‚³ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç‡',
        value: ((ga4Data?.metrics?.conversionRate || 0) * 100).toFixed(2) + '%',
        change: 8.9,
        icon: (
          <svg className="h-7 w-7 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
          </svg>
        ),
      },
    ];
    
    return (
      <div className="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3">
        {metrics.map((metric, index) => (
          <MetricCard key={index} {...metric} isLoading={isLoading} />
        ))}
      </div>
    );
  }
  ```

#### æˆæœç‰©
- `src/components/Dashboard/MetricCard.jsx`
- `src/components/Dashboard/MetricCards.jsx`

---

### 2.5 ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸ã®å®Ÿè£…
**ç›®çš„**: å…¨ã¦ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’çµ±åˆã—ãŸãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

#### ã‚¿ã‚¹ã‚¯
- [ ] **Dashboard ãƒšãƒ¼ã‚¸ã®æ›´æ–°**
  ```javascript
  // src/components/Dashboard.jsx
  import React, { useState, useEffect } from 'react';
  import { useNavigate, useSearchParams } from 'react-router-dom';
  import { useAuth } from '../contexts/AuthContext';
  import { useSite } from '../contexts/SiteContext';
  import { useSiteMetrics } from '../hooks/useSiteMetrics';
  import MainLayout from './Layout/MainLayout';
  import PeriodSelector from './Dashboard/PeriodSelector';
  import MetricCards from './Dashboard/MetricCards';
  
  export default function Dashboard() {
    const { currentUser } = useAuth();
    const { sites, selectedSite, selectSite } = useSite();
    const navigate = useNavigate();
    const [searchParams] = useSearchParams();
    
    // æœŸé–“ã®çŠ¶æ…‹ç®¡ç†
    const [period, setPeriod] = useState(() => {
      const endDate = new Date();
      const startDate = new Date();
      startDate.setDate(startDate.getDate() - 30);
      return {
        startDate: startDate.toISOString().split('T')[0],
        endDate: endDate.toISOString().split('T')[0],
      };
    });
    
    // URLã®siteIdãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ã‚µã‚¤ãƒˆã‚’é¸æŠ
    useEffect(() => {
      const siteIdFromUrl = searchParams.get('siteId');
      if (siteIdFromUrl && siteIdFromUrl !== selectedSite?.id) {
        selectSite(siteIdFromUrl);
      }
    }, [searchParams, selectedSite, selectSite]);
    
    // ãƒ‡ãƒ¼ã‚¿å–å¾—
    const { ga4, gsc, isLoading, isError, error, refetch } = useSiteMetrics(
      selectedSite?.id,
      period.startDate,
      period.endDate
    );
    
    // ã‚µã‚¤ãƒˆãŒé¸æŠã•ã‚Œã¦ã„ãªã„å ´åˆ
    if (!selectedSite) {
      return (
        <MainLayout
          title="ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰"
          subtitle="ã‚µã‚¤ãƒˆã‚’é¸æŠã—ã¦ãã ã•ã„"
          showSiteSelector={true}
        >
          <div className="p-6">
            <div className="flex min-h-[60vh] items-center justify-center rounded-lg border border-stroke bg-white p-12 shadow-sm dark:border-dark-3 dark:bg-dark-2">
              <div className="text-center">
                <div className="mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-full bg-primary/10">
                  <svg className="h-10 w-10 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" />
                  </svg>
                </div>
                <h2 className="mb-3 text-2xl font-bold text-dark dark:text-white">
                  ã‚µã‚¤ãƒˆã‚’é¸æŠã—ã¦ãã ã•ã„
                </h2>
                <p className="mb-8 text-body-color">
                  ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã‚µã‚¤ãƒˆé¸æŠãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‹ã‚‰<br />
                  åˆ†æã—ãŸã„ã‚µã‚¤ãƒˆã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚
                </p>
                {sites.length === 0 && (
                  <button
                    onClick={() => navigate('/sites/new')}
                    className="rounded-md bg-primary px-8 py-3 text-sm font-medium text-white hover:bg-opacity-90"
                  >
                    ã‚µã‚¤ãƒˆã‚’ç™»éŒ²
                  </button>
                )}
              </div>
            </div>
          </div>
        </MainLayout>
      );
    }
    
    // ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹
    if (isError) {
      return (
        <MainLayout
          title={`${selectedSite.siteName} - ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰`}
          subtitle="ã‚µã‚¤ãƒˆã®åˆ†æãƒ‡ãƒ¼ã‚¿ã¨æ”¹å–„çŠ¶æ³ã‚’ç¢ºèªã§ãã¾ã™"
          showSiteSelector={true}
        >
          <div className="p-6">
            <div className="rounded-lg border border-red-200 bg-red-50 p-6 dark:border-red-900/30 dark:bg-red-900/20">
              <div className="flex items-start gap-3">
                <div className="flex h-9 w-9 flex-shrink-0 items-center justify-center rounded-full bg-red-100 dark:bg-red-900/30">
                  <svg className="h-5 w-5 text-red-600 dark:text-red-400" fill="currentColor" viewBox="0 0 20 20">
                    <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clipRule="evenodd" />
                  </svg>
                </div>
                <div className="flex-1">
                  <h3 className="mb-2 text-base font-semibold text-red-800 dark:text-red-300">
                    ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ
                  </h3>
                  <p className="text-sm text-red-700 dark:text-red-400">
                    {error?.message || 'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ'}
                  </p>
                  <button
                    onClick={refetch}
                    className="mt-4 rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700"
                  >
                    å†è©¦è¡Œ
                  </button>
                </div>
              </div>
            </div>
          </div>
        </MainLayout>
      );
    }
    
    return (
      <MainLayout
        title={`${selectedSite.siteName} - ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰`}
        subtitle="ã‚µã‚¤ãƒˆã®åˆ†æãƒ‡ãƒ¼ã‚¿ã¨æ”¹å–„çŠ¶æ³ã‚’ç¢ºèªã§ãã¾ã™"
        showSiteSelector={true}
      >
        <div className="p-6 space-y-6">
          {/* æœŸé–“é¸æŠ */}
          <PeriodSelector onPeriodChange={setPeriod} />
          
          {/* ä¸»è¦æŒ‡æ¨™ã‚«ãƒ¼ãƒ‰ */}
          <MetricCards ga4Data={ga4} isLoading={isLoading} />
          
          {/* TODO: ãƒˆãƒ¬ãƒ³ãƒ‰ã‚°ãƒ©ãƒ•ï¼ˆv1.2.0ã§å®Ÿè£…ï¼‰ */}
          {/* TODO: ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆv1.2.0ã§å®Ÿè£…ï¼‰ */}
        </div>
      </MainLayout>
    );
  }
  ```

#### æˆæœç‰©
- æ›´æ–°ã•ã‚ŒãŸ `src/components/Dashboard.jsx`

---

## ğŸ§ª Phase 3: ãƒ†ã‚¹ãƒˆã¨ãƒ‡ãƒãƒƒã‚°ï¼ˆå„ªå…ˆåº¦: ä¸­ï¼‰

### 3.1 ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ
**ç›®çš„**: é–‹ç™ºç’°å¢ƒã§ã®å‹•ä½œç¢ºèª

#### ã‚¿ã‚¹ã‚¯
- [ ] **Firebase Emulator ã§ã®ãƒ†ã‚¹ãƒˆ**
  ```bash
  firebase emulators:start
  ```

- [ ] **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®èµ·å‹•**
  ```bash
  npm run dev
  ```

- [ ] **å‹•ä½œç¢ºèªé …ç›®**
  - [ ] ãƒ­ã‚°ã‚¤ãƒ³ â†’ ã‚µã‚¤ãƒˆé¸æŠ â†’ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤º
  - [ ] æœŸé–“é¸æŠã®å‹•ä½œ
  - [ ] ãƒ‡ãƒ¼ã‚¿ã®è¡¨ç¤º
  - [ ] ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å‹•ä½œ
  - [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

---

### 3.2 æœ¬ç•ªç’°å¢ƒãƒ†ã‚¹ãƒˆ
**ç›®çš„**: å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã§ã®å‹•ä½œç¢ºèª

#### ã‚¿ã‚¹ã‚¯
- [ ] **ãƒ‡ãƒ—ãƒ­ã‚¤**
  ```bash
  firebase deploy
  ```

- [ ] **å®Ÿéš›ã®ã‚µã‚¤ãƒˆã§ãƒ†ã‚¹ãƒˆ**
  - [ ] GA4ãƒ‡ãƒ¼ã‚¿ã®å–å¾—
  - [ ] GSCãƒ‡ãƒ¼ã‚¿ã®å–å¾—
  - [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®æ¸¬å®š
  - [ ] ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®ç¢ºèª

---

## ğŸ“ Phase 4: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆï¼ˆå„ªå…ˆåº¦: ä½ï¼‰

### 4.1 æŠ€è¡“ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

#### ã‚¿ã‚¹ã‚¯
- [ ] **APIä»•æ§˜æ›¸ã®ä½œæˆ**
  - Callable Functionsã®ä»•æ§˜
  - ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼
  - ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰

- [ ] **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ã®æ–‡æ›¸åŒ–**
  - ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ä»•çµ„ã¿
  - æœ‰åŠ¹æœŸé™ã®è¨­å®š
  - ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã®ä»•çµ„ã¿

---

## ğŸ“… ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆæ¨å®šï¼‰

### Week 1: Firebase Functions å®Ÿè£…
- **Day 1-2**: ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã¨GA4 Functionå®Ÿè£…
- **Day 3-4**: GSC Functionå®Ÿè£…
- **Day 5**: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Ÿè£…
- **Day 6-7**: ãƒ†ã‚¹ãƒˆã¨ãƒ‡ãƒãƒƒã‚°

### Week 2: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…
- **Day 1-2**: TanStack Query ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã¨ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
- **Day 3-4**: æœŸé–“é¸æŠã¨æŒ‡æ¨™ã‚«ãƒ¼ãƒ‰å®Ÿè£…
- **Day 5-7**: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰çµ±åˆã¨ãƒ†ã‚¹ãƒˆ

### Week 3: æœ€çµ‚èª¿æ•´ã¨ãƒªãƒªãƒ¼ã‚¹
- **Day 1-3**: ãƒã‚°ä¿®æ­£ã¨æœ€é©åŒ–
- **Day 4-5**: æœ¬ç•ªç’°å¢ƒãƒ†ã‚¹ãƒˆ
- **Day 6-7**: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆã¨v1.1.0ãƒªãƒªãƒ¼ã‚¹

**åˆè¨ˆ: ç´„3é€±é–“**

---

## ğŸ¯ æˆåŠŸåŸºæº–

### v1.1.0 ãƒªãƒªãƒ¼ã‚¹æ¡ä»¶
- [ ] GA4ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãå–å¾—ãƒ»è¡¨ç¤ºã•ã‚Œã‚‹
- [ ] GSCãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãå–å¾—ãƒ»è¡¨ç¤ºã•ã‚Œã‚‹
- [ ] 6ã¤ã®ä¸»è¦æŒ‡æ¨™ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] æœŸé–“é¸æŠãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
- [ ] ã‚µã‚¤ãƒˆåˆ‡ã‚Šæ›¿ãˆãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
- [ ] ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒæ­£å¸¸ã«æ©Ÿèƒ½ã™ã‚‹ï¼ˆãƒ’ãƒƒãƒˆç‡80%ä»¥ä¸Šï¼‰
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒé©åˆ‡ã«æ©Ÿèƒ½ã™ã‚‹
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ãŒæ­£ã—ãå‹•ä½œã™ã‚‹
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒè‰¯å¥½ï¼ˆåˆå›ãƒ­ãƒ¼ãƒ‰3ç§’ä»¥å†…ï¼‰

---

## ğŸ’° ã‚³ã‚¹ãƒˆè©¦ç®—ï¼ˆ1,000ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ Ã— 3ã‚µã‚¤ãƒˆï¼‰

### Firebase Functions
```
å®Ÿè¡Œå›æ•°: 6,000å›/æœˆï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡80%ï¼‰
å®Ÿè¡Œæ™‚é–“: å¹³å‡3ç§’
ã‚³ã‚¹ãƒˆ: 6,000 Ã— 3ç§’ Ã— $0.0000025 Ã— 12 = $0.54/å¹´
```

### Firestoreï¼ˆè»½é‡ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰
```
æ›¸ãè¾¼ã¿: 6,000å›/æœˆ Ã— 12 = 72,000å›/å¹´ = $0.13/å¹´
èª­ã¿å–ã‚Š: 30,000å›/æœˆ Ã— 12 = 360,000å›/å¹´ = $0.22/å¹´
ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: ã»ã¼ã‚¼ãƒ­ï¼ˆ1æ™‚é–“ã§å‰Šé™¤ï¼‰
```

### åˆè¨ˆ
```
$0.89/å¹´ â‰ˆ $0.07/æœˆ
```

**é©šç•°çš„ã«ä½ã‚³ã‚¹ãƒˆï¼ğŸ‰**

---

## ğŸ”® v1.2.0 ä»¥é™ã®äºˆå®šï¼ˆå‚è€ƒï¼‰

### v1.2.0: è©³ç´°åˆ†ææ©Ÿèƒ½
- ãƒˆãƒ¬ãƒ³ãƒ‰ã‚°ãƒ©ãƒ•ï¼ˆApexChartsï¼‰
- ãƒšãƒ¼ã‚¸åˆ¥åˆ†æ
- ãƒãƒ£ãƒãƒ«åˆ¥åˆ†æ
- ãƒ‡ãƒã‚¤ã‚¹åˆ¥åˆ†æ
- ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«

### v1.3.0: AIåˆ†ææ©Ÿèƒ½ï¼ˆGemini 2.5 Flashï¼‰
- ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•åˆ†æ
- ã‚¤ãƒ³ã‚µã‚¤ãƒˆæŠ½å‡º
- æ”¹å–„ææ¡ˆã®ç”Ÿæˆ

### v1.4.0: æ”¹å–„ç®¡ç†æ©Ÿèƒ½
- ã‚«ãƒ³ãƒãƒ³ãƒœãƒ¼ãƒ‰
- æ”¹å–„èª²é¡Œã®ç®¡ç†
- åŠ¹æœæ¸¬å®š

### v1.5.0: ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½
- PDF/Excelå‡ºåŠ›
- å®šæœŸãƒ¬ãƒãƒ¼ãƒˆé…ä¿¡
- ã‚«ã‚¹ã‚¿ãƒ ãƒ¬ãƒãƒ¼ãƒˆ

---

## ğŸ“Œ æ³¨æ„äº‹é …

### APIåˆ¶é™å¯¾ç­–
- **å¤šå±¤ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆ1æ™‚é–“ï¼‰ + Firestoreï¼ˆ1æ™‚é–“ï¼‰
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡**: 80%ä»¥ä¸Šã‚’ç›®æ¨™
- **ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°**: APIå‘¼ã³å‡ºã—æ•°ã‚’ç›£è¦–

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- **OAuth ãƒˆãƒ¼ã‚¯ãƒ³**: Firestoreã«å®‰å…¨ã«ä¿å­˜
- **Firestore Rules**: å³æ ¼ãªã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- **Callable Functions**: èªè¨¼ã¨ã‚µã‚¤ãƒˆæ‰€æœ‰æ¨©ã®ç¢ºèª

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- **åˆå›ãƒ­ãƒ¼ãƒ‰**: 3ç§’ä»¥å†…ã‚’ç›®æ¨™
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆ**: 1ç§’ä»¥å†…
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

---

## ğŸš€ é–‹å§‹æ–¹æ³•

1. **ã“ã®å®Ÿè£…è¨ˆç”»ã‚’ç¢ºèª**
2. **Phase 1 ã‹ã‚‰é †ç•ªã«å®Ÿè£…**
3. **å„ã‚¿ã‚¹ã‚¯å®Œäº†æ™‚ã«ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚’ä»˜ã‘ã‚‹**
4. **å•é¡ŒãŒç™ºç”Ÿã—ãŸã‚‰è¨˜éŒ²ã—ã¦å¯¾å¿œ**
5. **å…¨Phaseå®Œäº†å¾Œã«v1.1.0ã‚’ãƒªãƒªãƒ¼ã‚¹**

---

**ä½œæˆæ—¥**: 2025-10-24  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v1.1.0 å®Ÿè£…è¨ˆç”»ï¼ˆAPIéƒ½åº¦å‘¼ã³å‡ºã—æˆ¦ç•¥ï¼‰  
**æ¬¡å›æ›´æ–°**: Phase 1 å®Œäº†æ™‚
